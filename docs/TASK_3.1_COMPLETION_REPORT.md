# –û—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞—á–∏ 3.1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–∞—Ä—Å–µ—Ä–æ–≤

## ‚úÖ –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞

### –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

#### 1. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã (`backend/app/parsers/`)

**BaseParser (`base_parser.py`)**
- –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `parse_file()`, `validate_file()`
- –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è: —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

**TxtParser (`txt_parser.py`)** - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ `../analyse-text/backend`
- –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ (UTF-8, Windows-1251, KOI8-R, ISO-8859-1, ASCII)
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –∞–≤—Ç–æ—Ä–∞
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∂–∞–Ω—Ä–∞ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- –û—á–∏—Å—Ç–∫–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 10MB

**FB2Parser (`fb2_parser.py`)** - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ `../analyse-text/backend`
- –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ FictionBook 2.0 XML
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–æ–≥–∞—Ç—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: –∞–≤—Ç–æ—Ä—ã, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∂–∞–Ω—Ä—ã, –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è, –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ document-info (–ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è, –¥–∞—Ç–∞)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –≤—Å–µ—Ö —Ä–∞–∑–¥–µ–ª–æ–≤ –∏ –≥–ª–∞–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è XML —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ namespace

**PDFParser (`pdf_parser.py`)** - —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ PyPDF2
- –£–¥–∞–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ PDF (–Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü, –∑–∞–≥–æ–ª–æ–≤–∫–∏)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ PDF –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –∞–≤—Ç–æ—Ä–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 50MB

**EPUBParser (`epub_parser.py`)** - —Å–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π  
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑ ZIP –∞—Ä—Ö–∏–≤–æ–≤
- –ü–∞—Ä—Å–∏–Ω–≥ OPF –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (Dublin Core)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ HTML/XHTML —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ BeautifulSoup
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤, —Å—Ç–∏–ª–µ–π –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 100MB

#### 2. –§—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```python
# TXT
parse_txt_file(file_path) -> Dict[str, Any]
validate_txt_file(file_path) -> bool

# FB2  
parse_fb2_file(file_path) -> Dict[str, Any]
validate_fb2_file(file_path) -> bool

# PDF
parse_pdf_file(file_path) -> Dict[str, Any]
validate_pdf_file(file_path) -> bool

# EPUB
parse_epub_file(file_path) -> Dict[str, Any]
validate_epub_file(file_path) -> bool
```

#### 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π FileProcessor (`file_processor.py`)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é —Ñ–∞–π–ª–∞
- –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è: –±–∞–∑–æ–≤–∞—è + —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º API

#### 4. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
–í—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
```python
{
    'content': str,         # –û—á–∏—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
    'metadata': {           # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
        'format': str,      # –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
        'filename': str,    # –ò–º—è —Ñ–∞–π–ª–∞
        'file_size': int,   # –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
        'word_count': int,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤
        'line_count': int,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
        # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
        'txt_info': {...},  # –î–ª—è TXT
        'fb2_info': {...},  # –î–ª—è FB2
        'pdf_info': {...},  # –î–ª—è PDF
        'epub_info': {...}  # –î–ª—è EPUB
    }
}
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ (18/18)

**TxtParser (6 —Ç–µ—Å—Ç–æ–≤)**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
- ‚úÖ –§—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏

**FB2Parser (4 —Ç–µ—Å—Ç–∞)**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ namespace –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ FB2 —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ XML –≤–∞–ª–∏–¥–∞—Ü–∏—è

**PDFParser (3 —Ç–µ—Å—Ç–∞)**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ PDF —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**EPUBParser (3 —Ç–µ—Å—Ç–∞)**
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏–∑ OPF
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ HTML

**–§—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏ (2 —Ç–µ—Å—Ç–∞)**
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ–±–µ—Ä—Ç–æ–∫
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤ –º–µ—Ç–æ–¥–æ–≤ –ø–∞—Ä—Å–µ—Ä–æ–≤

### –ê–¥–∞–ø—Ç–∞—Ü–∏—è –≥–æ—Ç–æ–≤–æ–≥–æ –∫–æ–¥–∞

**‚úÖ –£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≥–æ—Ç–æ–≤—ã–µ –ø–∞—Ä—Å–µ—Ä—ã:**

1. **TXT Parser** - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ `../analyse-text/backend/app/parsers/txt_parser.py`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏
   - –£–ª—É—á—à–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω BaseParser –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

2. **FB2 Parser** - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –∏–∑ `../analyse-text/backend/app/parsers/fb2_parser.py`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è XML –æ–±—Ä–∞–±–æ—Ç–∫–∞
   - –£–ª—É—á—à–µ–Ω–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ document-info

**‚úÖ –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ –ø–∞—Ä—Å–µ—Ä—ã:**

3. **PDF Parser** - —Å–æ–∑–¥–∞–Ω —Å –Ω—É–ª—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PyPDF2
   - –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö PDF
   
4. **EPUB Parser** - —Å–æ–∑–¥–∞–Ω —Å –Ω—É–ª—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º BeautifulSoup + zipfile
   - –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ EPUB —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ Dublin Core –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –Ω–µ–∑–∞–≤–∏—Å–∏–º –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
2. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —á–µ—Ä–µ–∑ BaseParser
3. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - –∫–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –∏–º–µ–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
4. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ API
5. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - FileProcessor –æ—Å—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã –ø–∞—Ä—Å–µ—Ä–æ–≤
python3 -m pytest tests/test_parsers.py -v

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
python3 -m pytest tests/test_parsers.py::TestTxtParser -v
python3 -m pytest tests/test_parsers.py::TestFB2Parser -v
python3 -m pytest tests/test_parsers.py::TestPDFParser -v
python3 -m pytest tests/test_parsers.py::TestEPUBParser -v

# –ü—Ä–æ–≤–µ—Ä–∫–∞ FileProcessor
python3 -m pytest tests/test_file_upload.py::TestFileProcessor -v
```

### –ß—Ç–æ –¥–∞–ª—å—à–µ
‚úÖ **–ó–∞–¥–∞—á–∞ 3.1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∞  
‚úÖ **–ó–∞–¥–∞—á–∞ 3.2: File Processing Service** - –≤—ã–ø–æ–ª–Ω–µ–Ω–∞  
üîÑ –°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞: **3.3 Characters API** –∏–ª–∏ **4.1 NLP Integration**

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: $(date)  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É  
**–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: 100% (18/18 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—à–ª–∏)  
**–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –£—Å–ø–µ—à–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã TXT –∏ FB2 –ø–∞—Ä—Å–µ—Ä—ã + —Å–æ–∑–¥–∞–Ω—ã PDF –∏ EPUB
